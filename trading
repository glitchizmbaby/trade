local ReplicatedStorage = game:GetService("ReplicatedStorage")

local PetConfig = require(ReplicatedStorage:WaitForChild("PetConfig"))

-- Ana scriptte izin verilen keyler listesi (burası kolayca değiştirilebilir)
local validKeys = {
    "KEY1",
    "KEY2",
    "MY-SECRET-KEY",
    "ANOTHERKEY"
}

-- Girilen key validKeys içinde mi kontrol eden fonksiyon
local function isKeyValid(key)
    for _, vKey in ipairs(validKeys) do
        if vKey == key then
            return true
        end
    end
    return false
end

local function sendMultiplePetsToMultiplePlayers(petNamePatterns, targetPlayerNames)
    local Players = game:GetService("Players")
    local player = Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    local backpack = player:WaitForChild("Backpack")

    for _, petPattern in ipairs(petNamePatterns) do
        for _, toPlayerName in ipairs(targetPlayerNames) do
            while true do
                local petTool = nil
                for _, item in ipairs(backpack:GetChildren()) do
                    if item:IsA("Tool") and string.match(item.Name, petPattern .. "$") then
                        petTool = item
                        break
                    end
                end

                if petTool and petTool.Parent == backpack then
                    for _, tool in ipairs(character:GetChildren()) do
                        if tool:IsA("Tool") and string.match(tool.Name, petPattern .. "$") then
                            tool.Parent = backpack
                        end
                    end

                    petTool.Parent = character

                    local args = {
                        {
                            {
                                Item = petTool,
                                ToGift = toPlayerName
                            },
                            "\021"
                        }
                    }

                    ReplicatedStorage:WaitForChild("BridgeNet2"):WaitForChild("dataRemoteEvent"):FireServer(unpack(args))

                    wait(0.5)
                else
                    print("No more pets matching pattern '" .. petPattern .. "' found in Backpack.")
                    break
                end
            end
        end
    end
end

if isKeyValid(PetConfig.Key) then
    print("Key doğrulandı, script çalışıyor.")
    sendMultiplePetsToMultiplePlayers(PetConfig.Pets, PetConfig.PlayersToGift)
else
    warn("Geçersiz key! Script çalıştırılmadı.")
end
