-- LocalScript (ör. StarterPlayerScripts veya GUI)
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local backpack = player:WaitForChild("Backpack")

local PetConfig = require(ReplicatedStorage:WaitForChild("PetConfig"))

-- Ana script'e birkaç key koy (bunu sen düzenlersin)
local allowedKeys = {
    "myModuleKey_ABC123",
    "anotherAllowedKey_XYZ",
    "testKey_01"
}

-- doğrulama
local function isKeyAllowed(moduleKey)
    for _, k in ipairs(allowedKeys) do
        if moduleKey == k then
            return true
        end
    end
    return false
end

if not isKeyAllowed(PetConfig.Key) then
    warn("PetConfig key is invalid or not allowed. Script will not run.")
    return
end

-- Eğer allowed ise devam et:
local function sendMultiplePetsToMultiplePlayers(petNamePatterns, targetPlayerNames)
    for _, petPattern in ipairs(petNamePatterns) do
        for _, toPlayerName in ipairs(targetPlayerNames) do
            while true do
                local petTool = nil
                for _, item in ipairs(backpack:GetChildren()) do
                    if item:IsA("Tool") and string.match(item.Name, petPattern .. "$") then
                        petTool = item
                        break
                    end
                end

                if petTool and petTool.Parent == backpack then
                    for _, tool in ipairs(character:GetChildren()) do
                        if tool:IsA("Tool") and string.match(tool.Name, petPattern .. "$") then
                            tool.Parent = backpack
                        end
                    end

                    petTool.Parent = character

                    local args = {
                        {
                            {
                                Item = petTool,
                                ToGift = toPlayerName
                            },
                            "\021"
                        }
                    }

                    ReplicatedStorage:WaitForChild("BridgeNet2"):WaitForChild("dataRemoteEvent"):FireServer(unpack(args))

                    wait(0.5)
                else
                    -- artık o pattern'e uygun pet yok
                    break
                end
            end
        end
    end
end

-- çalıştır:
sendMultiplePetsToMultiplePlayers(PetConfig.Pets, PetConfig.PlayersToGift)
